# כלכלת הבית — Cursor IDE Rules

## Project Overview
אפליקציית ניהול תקציב משפחתי בעברית. Web + PWA. משתמש יחיד (ללא auth).
Tech: Next.js 14 (App Router), TypeScript, Tailwind CSS, shadcn/ui, Prisma, Supabase, Recharts.

## Language & Direction
- ALL UI text in Hebrew (עברית)
- HTML: `<html lang="he" dir="rtl">`
- Tailwind RTL is automatic with dir="rtl"
- Currency: ₪ (ILS), format: `new Intl.NumberFormat('he-IL', { style: 'currency', currency: 'ILS' })`
- Dates: `date-fns` with Hebrew locale (`import { he } from 'date-fns/locale'`)
- Payday: 11th of each month
- Calendar year: January to December

## Code Style
- TypeScript strict mode, NO `any`
- React Server Components by default, `"use client"` only when needed
- Prefer Server Actions over API Routes
- File naming: PascalCase (components), camelCase (hooks, utils, lib)
- Variable/function names in English, comments can be Hebrew
- Validate with Zod on server side
- Use Prisma ORM — never write raw SQL

## UI/UX Rules
- Mobile-first: design for 375px first, then scale up
- Breakpoints: sm:640, md:768, lg:1024
- Font: Heebo (Google Fonts) — `import { Heebo } from 'next/font/google'`
- Primary color: Cyan-600 (#0891B2)
- Income color: Emerald-500 (#10B981)
- Expense color: Red-500 (#EF4444)
- Warning color: Amber-500 (#F59E0B)
- Background: Slate-50 (#F8FAFC)
- Cards: white, rounded-xl, shadow-sm
- Buttons: rounded-lg
- Use shadcn/ui components (Sheet for mobile bottom sheets, Dialog for desktop modals)
- Icons: Lucide React
- Numbers should be large and prominent (text-2xl or larger for key metrics)
- Always show ₪ symbol after numbers

## Charts (Recharts)
- RTL: use `reversed` prop on XAxis
- Colors: match the app palette
- Responsive: use ResponsiveContainer
- Hebrew labels on axes and tooltips
- Pie chart for category breakdown
- Bar chart for weekly expenses
- Line chart for trends

## Navigation
- Mobile: Bottom navigation bar with 4 items (דשבורד, תקציב, חיסכון, דוחות) + FAB for quick add
- Desktop: Right sidebar (RTL) with full menu
- Global month selector in header

## Database
- Use Prisma with Supabase PostgreSQL
- Week number calculation: days 1-7 = week 1, 8-14 = week 2, 15-21 = week 3, 22-28 = week 4, 29+ = week 5
- Recurring transactions: auto-generate at month start
- Budget alerts: 80% warning, 95% danger, 100%+ exceeded

## File Structure
```
app/                    # Pages (App Router)
  layout.tsx           # Root layout (RTL, font, nav)
  page.tsx             # Dashboard
  transactions/page.tsx
  budget/page.tsx
  savings/page.tsx
  loans/page.tsx
  reports/page.tsx
  settings/page.tsx
  api/                 # API routes (only if Server Actions aren't enough)
components/
  ui/                  # shadcn/ui
  layout/              # Sidebar, MobileNav, Header, MonthSelector
  dashboard/           # Dashboard-specific components
  transactions/        # Transaction components
  budget/              # Budget components
  charts/              # Chart wrappers
  loans/               # Loan components
  savings/             # Savings components
lib/
  db.ts               # Prisma client
  utils.ts            # Helpers
  calculations.ts     # Business logic
  constants.ts        # Default categories, thresholds
  formatters.ts       # Currency, date formatting
hooks/                # Custom React hooks
stores/               # Zustand stores
prisma/
  schema.prisma
  seed.ts
types/
  index.ts
public/
  manifest.json       # PWA
  icons/
```

## Key Calculations
```
totalIncome = SUM(transactions WHERE type=INCOME in month)
totalExpenses = SUM(transactions WHERE type=EXPENSE in month)
balance = totalIncome - totalExpenses
fixedExpenses = SUM(transactions WHERE isFixed=true AND type=EXPENSE)
variableExpenses = totalExpenses - fixedExpenses
budgetUsage% = (actualSpent / plannedBudget) * 100
budgetRemaining = plannedBudget - actualSpent
```

## Important Notes
- Single user app — NO authentication, NO login page
- Opening the app goes straight to dashboard
- Default transaction type is EXPENSE (not income)
- Date defaults to today when adding transactions
- Week number is auto-calculated from date
- "Quick Add" = just amount + category (minimal friction)
- Full form has expandable "more details" section
- Copy budget from previous month feature
- Export to Excel (xlsx library) and PDF (jsPDF)
- Backup/restore via JSON export/import in settings
